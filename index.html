e<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Nuestro primer a√±o ‚ù§Ô∏è</title>

  <!-- IMPORTANTE: sube el n√∫mero v cuando cambies el CSS para forzar actualizaci√≥n -->
  <link rel="stylesheet" href="./styles.css?v=12">

  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600&family=Montserrat:wght@300;400&display=swap" rel="stylesheet">

  <!-- SOLO lo nuevo (quiz + confetti + unlock) va aqu√≠ para no tocar tu styles.css -->
  <style>
    /* Confetti overlay (sin tocar styles.css) */
    #confetti{
      position: fixed;
      inset: 0;
      width: 100%;
      height: 100%;
      z-index: 9999;
      pointer-events: none;
      display: block;
    }

    /* Portada: pista + hover */
    .cover-hint{
      margin-top: .45rem;
      font-size: .92rem;
      opacity: .85;
      text-align: center;
    }
    .cover-photo{
      cursor: pointer;
      transition: transform .18s ease, filter .18s ease;
    }
    .cover-photo:hover{
      transform: scale(1.01);
      filter: brightness(1.02);
    }

    /* QUIZ */
    .quiz{
      margin-top: 1.2rem;
      padding: 1.1rem;
      border-radius: 12px;
      border: 1px solid rgba(0,0,0,0.08);
      background: rgba(255,255,255,0.75);
      box-shadow: 0 6px 18px rgba(0,0,0,0.06);
      transition: border-color .2s ease, background .2s ease, transform .2s ease;
    }
    .quiz-title{
      font-family: 'Playfair Display', serif;
      font-size: 1.2rem;
      margin-bottom: .35rem;
    }
    .quiz-question{
      margin-bottom: .8rem;
      opacity: .95;
    }
    .quiz-options{
      display: flex;
      gap: .6rem;
      flex-wrap: wrap;
    }
    .quiz-btn{
      flex: 1 1 260px;
      text-align: left;
    }
    .quiz-feedback{
      margin-top: .8rem;
      font-weight: 700;
      display: none;
    }
    .quiz.answered .quiz-feedback{
      display: block;
    }

    /* Correcto = verde */
    .quiz.correct{
      border-color: rgba(34,197,94,0.55);
      background: rgba(34,197,94,0.10);
      animation: quizPop .28s ease;
    }
    .quiz.correct .quiz-feedback{
      color: #15803d;
    }

    /* Incorrecto = rojo */
    .quiz.wrong{
      border-color: rgba(239,68,68,0.55);
      background: rgba(239,68,68,0.10);
      animation: quizShake .32s ease;
    }
    .quiz.wrong .quiz-feedback{
      color: #b91c1c;
    }

    @keyframes quizPop{
      0%{ transform: scale(0.98); }
      100%{ transform: scale(1); }
    }
    @keyframes quizShake{
      0%{ transform: translateX(0); }
      25%{ transform: translateX(-6px); }
      50%{ transform: translateX(6px); }
      75%{ transform: translateX(-4px); }
      100%{ transform: translateX(0); }
    }

    /* ===== DESBLOQUEO POR FECHA ===== */
    .unlock-wrap{
      margin: 1.2rem auto 1rem;
      max-width: 520px;
      padding: 1rem;
      border-radius: 14px;
      background: rgba(255,255,255,0.72);
      border: 1px solid rgba(0,0,0,0.06);
      box-shadow: 0 6px 18px rgba(0,0,0,0.06);
    }
    .unlock-title{
      font-weight: 700;
      margin-bottom: .6rem;
    }
    .unlock-input{
      width: 100%;
      padding: .85rem 1rem;
      border-radius: 12px;
      border: 1px solid rgba(0,0,0,0.12);
      font-family: 'Montserrat', sans-serif;
      font-size: 1rem;
    }
    .unlock-hint{
      margin-top: .5rem;
      font-size: .9rem;
      opacity: .75;
    }
    .unlock-msg{
      margin-top: .6rem;
      font-weight: 800;
      min-height: 1.2em;
    }
    .unlock-msg.ok{ color: #15803d; }
    .unlock-msg.bad{ color: #b91c1c; }

    @keyframes unlockShake{
      0%{ transform: translateX(0); }
      25%{ transform: translateX(-6px); }
      50%{ transform: translateX(6px); }
      75%{ transform: translateX(-4px); }
      100%{ transform: translateX(0); }
    }
    .unlock-wrap.shake{
      animation: unlockShake .32s ease;
    }
  </style>
</head>

<body>
  <div class="bg"></div>

  <!-- Confetti overlay -->
  <canvas id="confetti" aria-hidden="true"></canvas>

  <main class="book">

    <!-- P√ÅGINA 0: EMPEZAR (con desbloqueo por fecha) -->
    <section class="page active" data-title="Empezar">
      <div class="event hero-card">
        <h1>Nuestro primer a√±o ‚ù§Ô∏è</h1>
        <p class="hero-sub">Para Alicia ‚ù§Ô∏è</p>

        <div class="unlock-wrap">
          <p class="unlock-title">üîí Para empezar, pon la fecha en la que empezamos a ser novios</p>
          <input id="unlockDate" class="unlock-input" type="date" />
          <p class="unlock-hint">Si no te deja elegir, escribe en formato YYYY-MM-DD</p>
          <p id="unlockMsg" class="unlock-msg" aria-live="polite"></p>
        </div>

        <!-- empieza bloqueado -->
        <button id="startBtn" class="btn btn-primary" type="button" disabled>EMPEZAR</button>

        <p class="hero-hint">Pulsa ‚ÄúEMPEZAR‚Äù para empezar a pasar p√°ginas ‚ú®</p>
      </div>
    </section>

    <!-- P√ÅGINA 1: PORTADA -->
    <section class="page" data-title="Portada">
      <div class="event">
        <h3>Feliz primer a√±o juntos Ali ‚ù§Ô∏è</h3>

        <!-- Confeti al click -->
        <img id="coverImg" class="event-photo cover-photo" src="./foto1.jpeg" alt="feliz primer a√±o juntos Ali ‚ù§Ô∏è" />

        <p>Esto es solo una peque√±a dedicatoria de como ha surgido todo y de nuestro recorrido, espero que te guste ‚ù§Ô∏è ‚ù§Ô∏è ‚ù§Ô∏è ‚ù§Ô∏è ‚ù§Ô∏è ‚ù§Ô∏è ‚ù§Ô∏è ‚ù§Ô∏è ‚ù§Ô∏è ‚ù§Ô∏è</p>
      </div>
    </section>

    <!-- P√ÅGINA 2 -->
    <section class="page" data-title="El d√≠a que me llamaste la atenci√≥n">
      <div class="event">
        <h3>‚ú® El d√≠a que me llamaste la atenci√≥n</h3>
        <img class="event-photo" src="./foto5.jpg" alt="El d√≠a que me llamaste la atenci√≥n" />
        <hr class="divider" />
        <img class="event-photo" src="./foto6.jpg" alt="El d√≠a que me llamaste la atenci√≥n" />
        <p>(Escribe aqu√≠ qu√© pas√≥ ese d√≠a. Qu√© viste en ella, qu√© pensaste, qu√© detalle te marc√≥.)</p>
      </div>
    </section>

    <!-- P√ÅGINA 3 (EXAMEN) -->
    <section class="page" data-title="Cuando empezamos a hablar semanalmente">
      <div class="event">
        <h3>üí¨ Cuando empezamos a hablar semanalmente, aprendiste muchas cosas de mi as√≠ que EXAMEN</h3>
        <p>(Responde a las siguientes preguntas sobre mi, cada acierto sube 1 pto, cada error quita 1 pto)</p>

        <p style="text-align:center; font-weight:700; margin-top:10px;">
          Puntuaci√≥n: <span id="score">0</span>
        </p>

        <!-- PREGUNTA 1 -->
        <div class="quiz" data-quiz aria-live="polite">
          <h4 class="quiz-title">üíò Pregunta 1</h4>
          <p class="quiz-question">¬øCu√°l es mi color favorito?</p>

          <div class="quiz-options">
            <button class="btn btn-ghost quiz-btn" type="button" data-answer="correct">üß° Naranja</button>
            <button class="btn btn-ghost quiz-btn" type="button" data-answer="wrong">üíú Morado</button>
          </div>

          <p class="quiz-feedback"></p>
        </div>

        <!-- PREGUNTA 2 -->
        <div class="quiz" data-quiz aria-live="polite">
          <h4 class="quiz-title">üíò Pregunta 2</h4>
          <p class="quiz-question">¬øCu√°l es mi n√∫mero de la suerte?</p>

          <div class="quiz-options">
            <button class="btn btn-ghost quiz-btn" type="button" data-answer="correct">23</button>
            <button class="btn btn-ghost quiz-btn" type="button" data-answer="wrong">22</button>
            <button class="btn btn-ghost quiz-btn" type="button" data-answer="wrong">33</button>
          </div>

          <p class="quiz-feedback"></p>
        </div>

        <!-- PREGUNTA 3 -->
        <div class="quiz" data-quiz aria-live="polite">
          <h4 class="quiz-title">üíò Pregunta 3</h4>
          <p class="quiz-question">¬øCu√°l es mi comida favorita?</p>

          <div class="quiz-options">
            <button class="btn btn-ghost quiz-btn" type="button" data-answer="wrong">üçï Pizza</button>
            <button class="btn btn-ghost quiz-btn" type="button" data-answer="wrong">üç£ Sushi</button>
            <button class="btn btn-ghost quiz-btn" type="button" data-answer="correct">üçù Espaguetis carbonara</button>
          </div>

          <p class="quiz-feedback"></p>
        </div>

        <!-- PREGUNTA 4 -->
        <div class="quiz" data-quiz aria-live="polite">
          <h4 class="quiz-title">üíò Pregunta 4</h4>
          <p class="quiz-question">¬øQu√© parte de ti me gusta mas?</p>

          <div class="quiz-options">
            <button class="btn btn-ghost quiz-btn" type="button" data-answer="correct">Ojos</button>
            <button class="btn btn-ghost quiz-btn" type="button" data-answer="correct">Sonrisa</button>
            <button class="btn btn-ghost quiz-btn" type="button" data-answer="correct">Cuerpo</button>
          </div>

          <p class="quiz-feedback"></p>
        </div>

        <!-- PREGUNTA 5 -->
        <div class="quiz" data-quiz aria-live="polite">
          <h4 class="quiz-title">üíò Pregunta 5</h4>
          <p class="quiz-question">¬øC√≥mo llamamos a cuando hacemos o pensamos algo a la vez?</p>

          <div class="quiz-options">
            <button class="btn btn-ghost quiz-btn" type="button" data-answer="correct">chuche</button>
            <button class="btn btn-ghost quiz-btn" type="button" data-answer="wrong">coincidencia</button>
            <button class="btn btn-ghost quiz-btn" type="button" data-answer="wrong">Santi</button>
          </div>

          <p class="quiz-feedback"></p>
        </div>

        <!-- PREGUNTA 6 -->
        <div class="quiz" data-quiz aria-live="polite">
          <h4 class="quiz-title">üíò Pregunta 6</h4>
          <p class="quiz-question">¬øCual color me pega mas segun t√∫?</p>

          <div class="quiz-options">
            <button class="btn btn-ghost quiz-btn" type="button" data-answer="correct">Verde</button>
            <button class="btn btn-ghost quiz-btn" type="button" data-answer="wrong">Rojo</button>
            <button class="btn btn-ghost quiz-btn" type="button" data-answer="wrong">Azul</button>
          </div>

          <p class="quiz-feedback"></p>
        </div>

        <!-- PREGUNTA 7 -->
        <div class="quiz" data-quiz aria-live="polite">
          <h4 class="quiz-title">üíò Pregunta 7</h4>
          <p class="quiz-question">¬øQu√© d√≠a fue nuestro primer beso?</p>

          <div class="quiz-options">
            <button class="btn btn-ghost quiz-btn" type="button" data-answer="wrong">6 febrero</button>
            <button class="btn btn-ghost quiz-btn" type="button" data-answer="wrong">22 diciembre</button>
            <button class="btn btn-ghost quiz-btn" type="button" data-answer="correct">20 diciembre</button>
          </div>

          <p class="quiz-feedback"></p>
        </div>

        <!-- PREGUNTA 8 -->
        <div class="quiz" data-quiz aria-live="polite">
          <h4 class="quiz-title">üíò Pregunta 8</h4>
          <p class="quiz-question">¬øQu√© sue√±o es el que mas veces te he dicho que quiero contigo?</p>

          <div class="quiz-options">
            <button class="btn btn-ghost quiz-btn" type="button" data-answer="wrong">Ser rico</button>
            <button class="btn btn-ghost quiz-btn" type="button" data-answer="correct">Casarme</button>
            <button class="btn btn-ghost quiz-btn" type="button" data-answer="wrong">Ser famoso</button>
          </div>

          <p class="quiz-feedback"></p>
        </div>

        <!-- PREGUNTA 9 -->
        <div class="quiz" data-quiz aria-live="polite">
          <h4 class="quiz-title">üíò Pregunta 9</h4>
          <p class="quiz-question">¬øEn una discusion soy mas de?</p>

          <div class="quiz-options">
            <button class="btn btn-ghost quiz-btn" type="button" data-answer="wrong">Hacer una broma para quitar tensi√≥n</button>
            <button class="btn btn-ghost quiz-btn" type="button" data-answer="wrong">Callarme y hablar despu√©s</button>
            <button class="btn btn-ghost quiz-btn" type="button" data-answer="correct">Hablarlo al momento</button>
          </div>

          <p class="quiz-feedback"></p>
        </div>

        <!-- PREGUNTA 10 -->
        <div class="quiz" data-quiz aria-live="polite">
          <h4 class="quiz-title">üíò Pregunta 10</h4>
          <p class="quiz-question">¬øQui√©n quiere mas al otro?</p>

          <div class="quiz-options">
            <button class="btn btn-ghost quiz-btn" type="button" data-answer="correct">Alicia</button>
            <button class="btn btn-ghost quiz-btn" type="button" data-answer="correct">Sergio</button>
          </div>

          <p class="quiz-feedback"></p>
        </div>

      </div>
    </section>

    <!-- P√ÅGINA 4 -->
    <section class="page" data-title="Cuando me di cuenta que sent√≠a AMOR">
      <div class="event">
        <h3>‚ù§Ô∏è Cuando me di cuenta que sent√≠a por primera vez AMOR</h3>
        <p>(Aqu√≠ va el momento exacto: d√≥nde estabas, qu√© pensaste, por qu√© supiste que era amor de verdad.)</p>
      </div>
    </section>

    <!-- P√ÅGINA 5 -->
    <section class="page" data-title="La primera vez que quedamos">
      <div class="event letter-event">
        <h3>La primera vez que quedamos</h3>

        <div class="date-wrap">
          <div class="date-text">
            <p>Esa semana la tengo grabada. Te lo dije la semana anterior: que quer√≠a quedar contigo para intentar hacer algo y que te enamorases de m√≠ (claro, yo no sab√≠a que ya te gustaba).</p>
            <p>Yo me acuerdo de estar todos los d√≠as muerto de dolor de barriga, de los nervios y de mariposas. Pero fue justo cuando fuimos a Vizzio cuando se me quitaron las dudas que ten√≠a sobre si todo iba a salir bien o no. Porque esa noche yo te estuve mirando todo el tiempo: no te apart√© la mirada ni un solo momento. Para m√≠ era la primera vez que sent√≠a algo tan fuerte sin ser absolutamente nada m√°s que amigos.</p>
            <p>Qu√© risa cuando me sal√≠ a la terraza con Kostadin y empec√© a hablar de ti, sobre c√≥mo no sab√≠a qu√© hacer porque estaba sintiendo tanto solo por estar CERCA DE TI, que el t√≠o se levant√≥ y me dijo: ‚Äúno seas un cag√≥n‚Äù. Y creo que, supongo, que gracias a eso fue que fui directo hacia ti, te cog√≠ de la mano y por segunda vez nos besamos. No te imaginas lo que estaba sintiendo en ese momento: no me estaba preocupando por nada, solo en sentir tu beso al m√°ximo para poder recordarlo.</p>
            <p>Fue ah√≠ cuando ya sab√≠a que daba igual que me odiases, acabase cay√©ndote mal o simplemente nos separase la vida: iba a hacer absolutamente todo por perseguirte y conseguir estar a tu lado.</p>
            <p>Dos d√≠as despu√©s lleg√≥ por fin nuestra PRIMERA CITA. Yo estaba muerto por dentro; no sab√≠a si tomarme 15 valerianas o simplemente morir...</p>
            <p>(tu texto sigue igual)</p>
          </div>

          <div class="date-photos">
            <figure class="side-figure">
              <img class="side-photo" src="./foto9.jpeg" alt="La primera vez que quedamos - flores" />
              <figcaption class="side-caption">El primer ramo de flores que doy en mi vida, tuyo</figcaption>
            </figure>

            <figure class="side-figure">
              <img class="side-photo" src="./foto8.jpeg" alt="Mensaje del d√≠a siguiente" />
              <figcaption class="side-caption">Este mensaje es lo que le escrib√≠ a F√°tima al d√≠a siguiente</figcaption>
            </figure>
          </div>
        </div>
      </div>
    </section>

    <!-- P√ÅGINA 6 -->
    <section class="page" data-title="Novios">
      <div class="event">
        <h3>üíû Novios üíû</h3>
        <p>(C√≥mo fue, c√≥mo lo pedisteis o c√≥mo se dio, qu√© sentiste, qu√© cambi√≥ a partir de ah√≠.)</p>
      </div>
    </section>

    <!-- P√ÅGINA 7 -->
    <section class="page" data-title="Nuestra relaci√≥n">
      <div class="event letter-event">
        <h3>üåô Nuestra relaci√≥n</h3>

        <div class="relation-wrap">
          <div class="relation-text">
            <p>Ali,</p>
            <p>(tu texto sigue igual)</p>
          </div>

          <img class="relation-photo" src="./foto7.jpeg" alt="Foto nuestra" />
        </div>
      </div>
    </section>
<!-- P√ÅGINA FINAL -->
<section class="page" data-title="Te amo">
  <div class="event final-card">
    <h2 class="final-title">Te amo</h2>
    <p class="final-sub">No hay palabras que puedan explicar lo mucho que eres para mi</p>

    <p class="final-question">¬øQuieres renovar y volver a ser mi novia otro a√±o mas?</p>

    <div class="final-actions">
      <button id="renewYes" class="btn btn-primary final-yes" type="button">S√≠</button>
      <button id="renewNo" class="btn btn-ghost final-no" type="button">No</button>
    </div>

    <p id="renewMsg" class="final-msg" aria-live="polite"></p>
  </div>
</section>

  </main>

  <!-- NAVEGACI√ìN -->
  <nav class="pager" aria-label="Navegaci√≥n">
    <button id="prevBtn" class="btn btn-ghost" type="button">Anterior</button>

    <div class="page-indicator">
      <span id="pageTitle">Empezar</span>
      <span class="dot">¬∑</span>
      <span id="pageCounter">1/1</span>
    </div>

    <button id="nextBtn" class="btn btn-primary" type="button">Siguiente</button>
  </nav>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const pages = Array.from(document.querySelectorAll(".page"));
      const prevBtn = document.getElementById("prevBtn");
      const nextBtn = document.getElementById("nextBtn");
      const startBtn = document.getElementById("startBtn");
      const pageTitle = document.getElementById("pageTitle");
      const pageCounter = document.getElementById("pageCounter");

      let current = 0;

      function showPage(i) {
        current = Math.max(0, Math.min(i, pages.length - 1));

        pages.forEach((p, idx) => {
          p.classList.toggle("active", idx === current);
        });

        const title = pages[current].dataset.title || `P√°gina ${current + 1}`;
        pageTitle.textContent = title;
        pageCounter.textContent = `${current + 1}/${pages.length}`;

        const onStart = current === 0;
        prevBtn.style.visibility = onStart ? "hidden" : "visible";
        nextBtn.style.visibility = onStart ? "hidden" : "visible";

        prevBtn.disabled = current === 0;
        nextBtn.disabled = current === pages.length - 1;

        window.scrollTo({ top: 0, behavior: "smooth" });
      }

      startBtn?.addEventListener("click", () => showPage(1));
      prevBtn.addEventListener("click", () => showPage(current - 1));
      nextBtn.addEventListener("click", () => showPage(current + 1));

      document.addEventListener("keydown", (e) => {
        if (e.key === "ArrowLeft") showPage(current - 1);
        if (e.key === "ArrowRight") showPage(current + 1);
      });

      showPage(0);

      /********************
       * CONFETTI (click en la imagen de portada)
       ********************/
      const confettiCanvas = document.getElementById("confetti");
      const cctx = confettiCanvas.getContext("2d");

      let confettiPieces = [];
      let confettiRunning = false;

      function resizeConfetti() {
        const dpr = Math.min(2, window.devicePixelRatio || 1);
        confettiCanvas.width = Math.floor(window.innerWidth * dpr);
        confettiCanvas.height = Math.floor(window.innerHeight * dpr);
        return dpr;
      }

      function launchConfetti() {
        const dpr = resizeConfetti();
        const W = confettiCanvas.width;
        const H = confettiCanvas.height;

        const count = 180;
        confettiPieces = [];

        for (let i = 0; i < count; i++) {
          confettiPieces.push({
            x: Math.random() * W,
            y: -20 - Math.random() * H * 0.2,
            vx: (Math.random() * 2 - 1) * 1.8 * dpr,
            vy: (2 + Math.random() * 4) * dpr,
            r: (2 + Math.random() * 5) * dpr,
            rot: Math.random() * Math.PI,
            vr: (Math.random() * 2 - 1) * 0.12,
            hue: Math.floor(Math.random() * 360),
            life: 0,
            ttl: 240 + Math.floor(Math.random() * 60)
          });
        }

        confettiRunning = true;
        requestAnimationFrame(confettiTick);
        setTimeout(() => { confettiRunning = false; }, 2600);
      }

      function confettiTick() {
        if (!confettiRunning) {
          cctx.clearRect(0, 0, confettiCanvas.width, confettiCanvas.height);
          return;
        }

        const W = confettiCanvas.width;
        const H = confettiCanvas.height;
        cctx.clearRect(0, 0, W, H);

        for (const p of confettiPieces) {
          p.x += p.vx;
          p.y += p.vy;
          p.rot += p.vr;
          p.life++;

          if (p.x < -30) p.x = W + 30;
          if (p.x > W + 30) p.x = -30;

          const alpha = Math.max(0, 1 - p.life / p.ttl);
          cctx.save();
          cctx.translate(p.x, p.y);
          cctx.rotate(p.rot);
          cctx.globalAlpha = alpha;
          cctx.fillStyle = `hsl(${p.hue} 90% 60%)`;
          cctx.fillRect(-p.r, -p.r * 0.6, p.r * 2.2, p.r * 1.2);
          cctx.restore();
        }

        requestAnimationFrame(confettiTick);
      }

      resizeConfetti();
      window.addEventListener("resize", resizeConfetti);

      const coverImg = document.getElementById("coverImg");
      coverImg?.addEventListener("click", launchConfetti);

      /********************
       * QUIZ (M√öLTIPLES preguntas + puntuaci√≥n)
       ********************/
      let score = 0;
      const scoreEl = document.getElementById("score");

      function setScore(v){
        score = v;
        if (scoreEl) scoreEl.textContent = String(score);
      }

      document.querySelectorAll(".quiz[data-quiz]").forEach((quiz) => {
        const feedback = quiz.querySelector(".quiz-feedback");
        const buttons = quiz.querySelectorAll("button[data-answer]");

        buttons.forEach((btn) => {
          btn.addEventListener("click", () => {
            if (quiz.classList.contains("answered")) return;

            const result = btn.dataset.answer; // "correct" o "wrong"
            quiz.classList.add("answered");
            buttons.forEach(b => b.disabled = true);

            if (result === "correct") {
              quiz.classList.add("correct");
              if (feedback) feedback.textContent = "‚úÖ Correcto üíò";
              setScore(score + 1);
            } else {
              quiz.classList.add("wrong");
              if (feedback) feedback.textContent = "‚ùå Incorrecto üòÑ";
              setScore(score - 1);
            }
          });
        });
      });

      /********************
       * DESBLOQUEO: fecha para habilitar "EMPEZAR"
       ********************/
      // ‚úÖ CAMBIA ESTA FECHA POR LA VUESTRA (formato YYYY-MM-DD)
      const COUPLE_DATE = "2025-02-22";

      const unlockDate = document.getElementById("unlockDate");
      const unlockMsg = document.getElementById("unlockMsg");

      function normalizeDate(v){
        if (!v) return "";
        v = v.trim();
        const iso = /^\d{4}-\d{2}-\d{2}$/;
        if (iso.test(v)) return v;

        const es = /^(\d{2})\/(\d{2})\/(\d{4})$/;
        const m = v.match(es);
        if (m){
          const dd = m[1], mm = m[2], yyyy = m[3];
          return `${yyyy}-${mm}-${dd}`;
        }
        return v;
      }

      function setStartEnabled(enabled){
        if (!startBtn) return;
        startBtn.disabled = !enabled;
      }

      function showUnlockMessage(ok, text){
        if (!unlockMsg) return;
        unlockMsg.textContent = text;
        unlockMsg.classList.toggle("ok", ok);
        unlockMsg.classList.toggle("bad", !ok);
      }

      function shakeUnlock(){
        const box = document.querySelector(".unlock-wrap");
        if (!box) return;
        box.classList.remove("shake");
        void box.offsetWidth;
        box.classList.add("shake");
      }

      function checkUnlock(){
        const v = normalizeDate(unlockDate?.value || "");
        if (!v){
          setStartEnabled(false);
          showUnlockMessage(false, "");
          return;
        }
        if (v === COUPLE_DATE){
          setStartEnabled(true);
          showUnlockMessage(true, "‚úÖ Correcto");
        } else {
          setStartEnabled(false);
          showUnlockMessage(false, "‚ùå Esa no es‚Ä¶ prueba again");
          shakeUnlock();
        }
      }

      // Estado inicial: bloqueado
      setStartEnabled(false);

      unlockDate?.addEventListener("input", checkUnlock);
      unlockDate?.addEventListener("change", checkUnlock);
/********************
 * FINAL: "Renovar otro a√±o" (NO agranda S√ç 5 veces, a la 6¬™ desaparece NO)
 ********************/
const renewYes = document.getElementById("renewYes");
const renewNo  = document.getElementById("renewNo");
const renewMsg = document.getElementById("renewMsg");

let noCount = 0;

function applyYesSize(steps){
  const s = Math.min(steps, 5);        // m√°ximo 5 crecimientos
  const scale = 1 + s * 0.18;          // ajusta si lo quieres m√°s bestia
  renewYes.style.transform = `scale(${scale})`;
  renewYes.style.fontSize = `${1 + s * 0.12}rem`;
  renewYes.style.padding  = `${0.85 + s * 0.10}rem ${1.10 + s * 0.20}rem`;
}

renewNo?.addEventListener("click", () => {
  noCount++;

  if (noCount <= 5) {
    applyYesSize(noCount);
    if (renewMsg) renewMsg.textContent = "üòÑ Esa respuesta no vale‚Ä¶ prueba otra vez";
    return;
  }

  // 6¬™ vez: NO desaparece y queda solo S√ç gigante
  renewNo.style.display = "none";
  applyYesSize(5);
  if (renewMsg) renewMsg.textContent = "üòå Vale‚Ä¶ entonces solo queda una opci√≥n ‚ù§Ô∏è";
});

renewYes?.addEventListener("click", () => {
  if (renewMsg) renewMsg.textContent = "üíò S√çIIII. Otro a√±o m√°s.";
  // Si existe tu confetti, lo lanzamos:
  if (typeof launchConfetti === "function") launchConfetti();
});

    });
  </script>
</body>
</html>




















